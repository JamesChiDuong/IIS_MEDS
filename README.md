# MEDS

## Matrix Equivalence Digital Signature

This repository provides the reference implementation of the PQC signature scheme MEDS
as submitted to the NIST PQC Signature standardization process.

The website accompanying the MEDS submission is [meds-pqc.org](https://www.meds-pqc.org/).

The submission document with the MEDS specification can be found [here](https://www.meds-pqc.org/spec/MEDS.pdf).

## C Reference Implementation

The reference implementation in directory `ref/` can be compiled
using the provided Makefile.

The Python script `ref/params.py` requires python-tabulate:

```console
   pip install tabulate
```

We provide three programs:
- `test` to run at test of key generation, signing, and verification,(`Will do in future`)
- `bench` for benchmarking the implementation using several rounds, (`Will do in future`)
- `KAT_test_Stream` for computing known answer tests. (`Have been done`)

The test can be compiled and run by

```console
   make RUN  (`Will do in future`)
```

the benchmark using

```console
   make BENCH (`Will do in future`)
```

The KAT test include 2 version: Version 1.0: Original MED with IO serial added, Version 1.1: MED with seperated data which is sent by stream to Python script

### VERSION 1.0:

The file `KAT_test_Serial_IO.c` and `KAT_test_Serial.py`

When we run this command, the program will generate the `buld/result` folder which contains these data of KAT_test_Stream.
- The file `FromPython_PQCsignKAT_MEDS167717.req` and `FromPython_PQCsignKAT_MEDS167717.rsp` contain the pk,sk and sign data from embedded board or PC.

### VERSION 1.1:

The file `KAT_test_Stream.c` and `KAT_test_Stream.py`

When we run this command, the program will generate the `buld/result` folder which contains these data of KAT_test_Stream.
- The file `FromPython_PQCsignKAT_MEDS167717.req` and `FromPython_PQCsignKAT_MEDS167717.rsp` contain the pk,sk and sign data from embedded board or PC.
- The file `FromPython_Result_Keygen_MEDS167717.txt` and `FromPython_Result_Sig_MEDS167717.txt` contains the seperate data to create the pk,sk and sign data from embedded board or PC.


Each version includes 2 target:

- TARGET = unix
```console
   make TARGET=unix
```
- TARGET = stm32f4
```console
   make TARGET=stm32f4 KAT_test_Stream.bin
```

The default parameter set is the `toy` parameter set. Another parameter set can be selected using `PARAM`, e.g.:

```console
   make RUN PARAM=MEDS9923
```

A list of available parameter sets can be obtained by:

```console
   ./params.py -l
```

To run all targets, add `_ALL` to `RUN`, `BENCH`, and `KAT`, e.g.:

```console
   make RUN_ALL (`Will do in future`)
```

When the code is compiled with `DEBUG` defined, exhaustive step-by-step debugging is produced and written to `stderr`.

The code package of the MEDS NIST submission with dedicated directories for each parameter set can be generated by

```console
   ./NIST.sh
```


## Sage Reference Implementation

The Sage reference implementation in directory `sage-ref/`
requires PyCryptodome for SHAKE.

Install PyCryptodome by:

```console
   sage --pip install PyCryptodome
```

To test the KAT_Stream data, open the `KAT_test_Serial_IO.py` file:
```console
   python sage-ref/KAT_test_Serial_IO.py /dev/ttyUSB0
```
The port`/dev/ttyUSB*` for embedded board with `TARGET=stm32f4`, `/dev/pts/*` with `TARGET=unix`


A toy example of MEDS can be run using the following command:

```console
   ./meds.sage
```

A list of the MEDS instances for the parameter set can be obtained with the following command:

```console
   ./meds.sage -l
```

A specific parameter set can be run by:

```console
   ./meds.sage [PARAMETER SET]
```

The Sage version can be compared to the C version using the KAT files and the script `KAT_check.sage`.
There is a make target to easily generate and compare KAT files, e.g.:

```console
   make KAT PARAM=MEDS9923
   make KAT_ALL
```

### Requirements:

Tested with SageMath version 9.6.

The Python code files require Python version 3.8 or newer.



## Africacrypt 2023

The source code accompanying the Africacrypt 2023 paper:

- Tung Chou, Ruben Niederhagen, Edoardo Persichetti,
  Tovohery Hajatiana Randrianarisoa, Krijn Reijnders, Simona Samardjiska,
  and Monika Trimoska:
  *"Take your MEDS: Digital Signatures from Matrix Code Equivalence"*.
  Progress in Cryptology - AfricaCrypt 2023.
  Lecture Notes in Computer Science, Springer, 2023.

is in branch `Africacrypt`.

