# MEDS

## Matrix Equivalence Digital Signature

This repository provides the reference implementation of the PQC signature scheme MEDS
as submitted to the NIST PQC Signature standardization process.

The website accompanying the MEDS submission is [meds-pqc.org](https://www.meds-pqc.org/).

The submission document with the MEDS specification can be found [here](https://www.meds-pqc.org/spec/MEDS.pdf).

## C Reference Implementation

The reference implementation in directory `ref/` can be compiled
using the provided Makefile.

The Python script `ref/params.py` requires python-tabulate:

```console
   pip install tabulate
```

In the original having:

- `test` to run at test of key generation, signing, and verification.
- `bench` for benchmarking the implementation using several rounds.
- `KAT_test` for computing known answer tests.

Because this project still can not implement into the embedded board. So, that why these file generated to implement into embedded board.

Now, only file `KAT_test` is revised with two version: Version 1.0: Original MED with IO serial added, Version 1.1: MED with seperated data which is sent by stream to Python script

- Version 1.0: Can implement with IO serial, but only `TARGET=unix` can implement, the `TARGET=stm32f4` can not implement due to the memory overflow.

- Version 1.1: Can implemnt with IO serial in `TARGET=unix` and `TARGET=stm32f4`.

### VERSION 1.0:

The file `KAT_test_Serial_IO.c` and `KAT_test_Serial.py`

When we run this command, the program will generate the `buld/result` folder which contains these data of KAT_test_Stream.

- The file `FromPython_PQCsignKAT_MEDS167717.req` and `FromPython_PQCsignKAT_MEDS167717.rsp` contain the pk,sk and sign data from embedded board or PC.

### VERSION 1.1:

The file `KAT_test_Stream.c` and `KAT_test_Stream.py`

When we run this command, the program will generate the `buld/result` folder which contains these data of KAT_test_Stream.

- The file `FromPython_PQCsignKAT_MEDS167717.req` and `FromPython_PQCsignKAT_MEDS167717.rsp` contain the pk,sk and sign data from embedded board or PC.
- The file `FromPython_Result_Keygen_MEDS167717.txt` and `FromPython_Result_Sig_MEDS167717.txt` contains the seperate data to create the pk,sk and sign data from embedded board or PC.

Each version 2 target:

- TARGET = unix

Running make command

```console
   make TARGET=unix
```

Debugging: Haven't design it. Can refer in this link: https://github.com/MrPugh/STM32-Discovery

- TARGET = stm32f4 (only can implement with Version 1.1)

Running make command

```console
   make TARGET=stm32f4 KAT_test_Stream.bin
```

Program the device with st-flash

```console
   st-flash write build/KAT_test_Stream.bin 0x8000000
```

Debug:
In one console start st-util and check which debugging port is opened, by default 4242.

In another colsole, start gdb:

```console
   gdb-multiarch -ex 'set remotetimeout 10' -ex 'target remote :4242' -ex load -ex 'break main' build/KAT_test_Stream.elf
```

The default parameter set is the `toy` parameter set. Another parameter set can be selected using `PARAM_OBJ` in make file, e.g.:

When the code is compiled with `DEBUG` defined, exhaustive step-by-step debugging is produced and written to `stderr`.

The code package of the MEDS NIST submission with dedicated directories for each parameter set can be generated by

```console
   ./NIST.sh
```

## Sage Reference Implementation

The Sage reference implementation in directory `sage-ref/`
requires PyCryptodome for SHAKE.

Install PyCryptodome by:

```console
   sage --pip install PyCryptodome
```

To test the KAT_Stream data, open the `KAT_test_Serial_IO.py` file:

```console
   python sage-ref/KAT_test_Serial_IO.py /dev/ttyUSB0
```

The port`/dev/ttyUSB*` for embedded board with `TARGET=stm32f4`, `/dev/pts/*` with `TARGET=unix`

A toy example of MEDS can be run using the following command:

```console
   ./meds.sage
```

A list of the MEDS instances for the parameter set can be obtained with the following command:

```console
   ./meds.sage -l
```

A specific parameter set can be run by:

```console
   ./meds.sage [PARAMETER SET]
```

The Sage version can be compared to the C version using the KAT files and the script `KAT_check.sage`.
There is a make target to easily generate and compare KAT files, e.g.:

```console
   make KAT PARAM=MEDS9923
   make KAT_ALL
```

### Requirements:

Tested with SageMath version 9.6.

The Python code files require Python version 3.8 or newer.

## Africacrypt 2023

The source code accompanying the Africacrypt 2023 paper:

- Tung Chou, Ruben Niederhagen, Edoardo Persichetti,
  Tovohery Hajatiana Randrianarisoa, Krijn Reijnders, Simona Samardjiska,
  and Monika Trimoska:
  _"Take your MEDS: Digital Signatures from Matrix Code Equivalence"_.
  Progress in Cryptology - AfricaCrypt 2023.
  Lecture Notes in Computer Science, Springer, 2023.

is in branch `Africacrypt`.
